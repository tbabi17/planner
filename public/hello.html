
<html>
<head>
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <script src="/node_modules/angular/angular.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Ubuntu:regular,bold&subset=Latin">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
  <script src="/public/FileSaver.js"></script>
  <script src="/public/jquery.cookie.js"></script>
  <script src="/node_modules/html-docx-js/dist/html-docx.js"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <link rel="stylesheet" href="public/css.css" />

</head>
<body ng-app="plannerApp" ng-controller="plannerCtrl">
  <div class="modal">
  <div class="modal__container">
    <div class="modal__featured">
      <button type="button" class="button--transparent button--close" ng-click="next(npage, cpage)">
        <svg class="nc-icon glyph" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32">
          <g><path fill="#ffffff" d="M1.293,15.293L11,5.586L12.414,7l-8,8H31v2H4.414l8,8L11,26.414l-9.707-9.707 C0.902,16.316,0.902,15.684,1.293,15.293z"></path> </g></svg>
        <span class="visuallyhidden">Return to Product Page</span>
      </button>
      <img src="https://cdn-icons-png.flaticon.com/512/7590/7590135.png" class="modal__product"/>
      <div class="modal__product_info">
        <span>Бизнес төлөвлөгөө</span>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дээр нь элсэлтийн шалгалтынх нь талаар сонсоод надаас илүү сайн хүүхдүүд
        зөндөө байгаа даа, сонгоны хүүхдүүд л тэнцэнэ дээ гээд сонирхож байсан ч
        гэлээ өөрийгөө чадахгүй гэж бодоод орхичихсон байсан.<br>
        Мөн мал аж ахуйн болон газар тариалангийн машин, тоног төхөөрөмж, барилга байгууламжийн мэдээлэл, газар ашиглалт, хөрсний доройтол, ургацын хорогдол, бордоо, ургамал хамгааллын бодисын хэрэглээ, бүтээгдэхүүний зардал, хүнсний хангамж, аюулгүй байдлын талаарх дэлгэрэнгүй статистикийн мэдээлэл бий болгоно.
      </div>
      <div class="modal__circle"></div>
    </div>
    <div class="modal__content">
      <form id="form_0">
        <label class="subtitle">Та бизнес төлөвлөгөөгөө өөрөө бичих боломжтой</label>
        <br>
        <hr>
        <div id="signed" style="margin-top: 30px;">
          <span style="color: #6f6f6f; display: block; margin-bottom: 10px;">Та өөрийн Google аккаунтыг ашиглан системд бүртгүүлэн ашиглах боломжтой.</span>
          <script src="https://accounts.google.com/gsi/client" async defer></script>
          <div id="g_id_onload"
               data-client_id="313982312140-k2dq3b0usf4dcfrf2na4vjetvno8dgdi.apps.googleusercontent.com"
               data-callback="handleCredentialResponse">
          </div>
          <div class="g_id_signin" data-type="standard" data-locale="mn_MN" data-size="large" data-width="300" data-text="Google-р нэвтрэх" data-shape="rectangle"></div>
        </div>

        <div id="startPlan">
          <button type="button" class="button" hidden ng-click="onSignIn()" id="startBtnPlan" style="margin-top: 30px;">ЭХЛЭХ</button>
          <div ng-if="signedUser.name" class="titler">Миний үүсгэсэн төлөвлөгөө</div>
          <br>
          <table id="planList" hidden class="plan">
            <thead>
              <tr>
                <td style="text-align:left;">#</td>
                <td style="text-align:left;">Төслийн нэр</td>
                <td style="text-align:left;">Үүсгэсэн хэрэглэгч</td>
                <td style="text-align:left;">Үүсгэсэн огноо</td>
                <td style="text-align:left;">Төлөв</td>
                <td style="text-align:left;">Үйлдэл</td>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="item in planlist">
                <td>{{$index+1}}</td>
                <td style="width:35%" ng-click="go(item)">{{item.pr_name}}</td>
                <td style="width:20%" ng-click="go(item)">{{item.pr_user_name}}</td>
                <td style="width:15%">{{item.pr_created_date.replace('T', ' ').replace('Z', ' ')}}</td>
                <td style="width:15%">Идэвхтэй</td>
                <td style="width:15%"><a href="" class="del" ng-click="deletePlan(item)">Устгах</a>&nbsp;&nbsp;&nbsp;
                      <a href="" ng-click="wordX(item)">Татах</a>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td></td>
                <td><a href="" ng-click="newPlan()">Шинээр үүсгэх +<a></td>
                <td></td>
                <td></td>
                <td ></td>
                <td ></td>
              </tr>
            </tfoot>
          </table>

          <br>

          <div ng-if="signedUser.name" class="titler">Загвар төслүүд</div>
          <br>
          <div class="planner">
            <img src="https://cdn-icons-png.flaticon.com/512/6796/6796010.png"/>
            <h2>Creative demos</h2>
            Design is everywhere. From the dress you’re wearing to the smartphone you’re holding. If you think good design is expensive.
          </div>
          <div class="planner">
            <img src="https://cdn-icons-png.flaticon.com/512/6796/6796020.png"/>
            <h2>Creative demos</h2>
            Design is everywhere. From the dress you’re wearing to the smartphone you’re holding. If you think good design is expensive.
          </div>
          <div class="planner">
            <img src="https://cdn-icons-png.flaticon.com/512/6796/6796017.png"/>
            <h2>Creative demos</h2>
            Design is everywhere. From the dress you’re wearing to the smartphone you’re holding. If you think good design is expensive.
          </div>
        </div>
      </form>

      <form id="form_1" hidden ng-submit="next(2,1, true)">
        <label class="subtitle">Үндсэн мэдээлэл</label>
        <label class="righttitle">1/10</label>
        <br>
        <hr>
        <div class="formed">
          <div style="width: 860px;">
          <div class="hint">Дээр нь элсэлтийн шалгалтынх нь талаар сонсоод надаас илүү сайн хүүхдүүд зөндөө байгаа даа, сонгоны хүүхдүүд л тэнцэнэ дээ гээд сонирхож байсан ч гэлээ өөрийгөө чадахгүй гэж бодоод орхичихсон байсан.</div>
          <div class="ui-widget" id="info_1" ng-if="errorMsg.length > 0">
            <div class="ui-state-error ui-corner-all" style="padding: 0 .7em;">
              <p>
              <span class="ui-icon ui-icon-alert"
                    style="float: left; margin-right: .3em;"></span>
                <strong>Алдаа:</strong> {{errorMsg}}
              </p>
            </div>
          </div>

          <ul class="form-list">
            <li class="form-list__row form-list__row--inline">
              <div class="c2">
                <label>Төслийн нэр</label>
                <input type="text" name="pr_name" required="" ng-model="plan.pr_name" />
              </div>
              <div class="c2">
                <label>Санхүүжүүлэгч байгууллага</label>
                <input type="text" name="pr_fund_org" required="" ng-model="plan.pr_fund_org" />
              </div>
              <div class="c1">
                <label>Хэрэгжүүлэх хугацаа</label>
                <select ng-model="plan.pr_duration" name="pr_duration" required>
                  <option selected></option>
                  <option ng-value="1" value="1">1 жил</option>
                  <option ng-value="2" value="2">2 жил</option>
                  <option ng-value="3" value="3">3 жил</option>
                  <option ng-value="4" value="4">4 жил</option>
                  <option ng-value="5" value="5">5 жил</option>
                </select>
              </div>
            </li>

            <li class="form-list__row form-list__row--inline">
              <div class="c2">
                <label>Төсөл хэрэгжүүлэгчийн нэр</label>
                <input type="text" name="pr_owner_name" required="" ng-model="plan.pr_owner_name" />
              </div>
              <div class="c1">
                <label>Төсөв нийт</label>

                <input type="text" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"
                       name="pr_budget_total" required="" ng-model="plan.pr_budget_total"/>
              </div>
              <div class="c1">
                <label>Санхүүжүүлэгчээс</label>
                <input type="text" ng-change="plan.pr_budget_me = t2n(plan.pr_budget_total) - t2n(plan.pr_budget_funder)" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="pr_budget_funder" required="" ng-model="plan.pr_budget_funder"/>
              </div>
              <div class="c1">
                <label>Өөрөөс</label>
                <input type="text" readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="pr_budget_me" required ng-model="plan.pr_budget_me"/>
              </div>
            </li>

            <li class="form-list__row form-list__row--inline">
              <div class="c1">
                <label>Зорилго</label>
                <textarea type="text" name="pr_purpose" required rows="5" ng-model="plan.pr_purpose">{{plan.pr_purpose}}</textarea>
              </div>
              <div class="c1">
                <label>Хүлээгдэж буй үр дүн</label>
                <textarea type="text" name="pr_expected_result" required required rows="5" ng-model="plan.pr_expected_result">{{plan.pr_expected_result}}</textarea>
              </div>
            </li>

            <li class="form-list__row form-list__row--inline">
              <div class="c1">
                <label>Бизнесийн танилцуулга</label>
                <textarea name="pr_business_detail" required="" rows="5" ng-model="plan.pr_business_detail">{{plan.pr_business_detail}}</textarea>
              </div>
              <div class="c1">
                <label>Төслийн үндэслэл</label>
                <textarea name="pr_grounds" required="" rows="5" ng-model="plan.pr_grounds">{{plan.pr_grounds}}</textarea>
              </div>
            </li>

            <!-- <li class="form-list__row form-list__row--inline">
              <div>
                <label>Expiration Date</label>
                <div class="form-list__input-inline">
                  <input type="text" name="cc_month" placeholder="MM"  pattern="\\d*" minlength="2" maxlength="2" required="" />
                  <input type="text" name="cc_year" placeholder="YY"  pattern="\\d*" minlength="2" maxlength="2" required="" />
                </div>
              </div>
              <div>
                <label>
                  CVC

                  <a href="#cvv-modal" class="button--transparent modal-open button--info">
                    <svg class="nc-icon glyph" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16"><g> <path fill="#35a4fb" d="M8,0C3.6,0,0,3.6,0,8s3.6,8,8,8s8-3.6,8-8S12.4,0,8,0z M8,13c-0.6,0-1-0.4-1-1c0-0.6,0.4-1,1-1s1,0.4,1,1 C9,12.6,8.6,13,8,13z M9.5,8.4C9,8.7,9,8.8,9,9v1H7V9c0-1.3,0.8-1.9,1.4-2.3C8.9,6.4,9,6.3,9,6c0-0.6-0.4-1-1-1 C7.6,5,7.3,5.2,7.1,5.5L6.6,6.4l-1.7-1l0.5-0.9C5.9,3.6,6.9,3,8,3c1.7,0,3,1.3,3,3C11,7.4,10.1,8,9.5,8.4z"></path> </g></svg>
                    <span class="visuallyhidden">What is CVV?</span>
                  </a>
                </label>
                <input type="text" name="cc_cvc" placeholder="123" pattern="\\d*" minlength="3" maxlength="4" required="" />
              </div>
            </li> -->
          </ul>
          </div>
        </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(0,1)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
            <button type="button" class="button" style="right: 0" ng-click="planSave(1)">ХАДГАЛАХ</button>
          </li>
        </ul>
      </form>

      <form id="form_2" hidden  ng-submit="next(3,2)">
        <label class="subtitle">Хөрөнгө оруулалтын төлөвлөгөө</label>
        <label class="righttitle">2/10</label>
        <br>
        <hr>
        <div class="formed">
          <table style="width: 900px;">
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 30%">Зүйл</td>
                <td style="width: 15%;">Зардал</td>
                <td style="width: 15%">Огноо</td>
                <td style="width: 40%">Тайлбар</td>
                <td style=""></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td >Тоног төхөөрөмж</td>
                <td></td>
                <td></td>
                <td ></td>
                <td></td>
              </tr>
              <tr ng-repeat="item in plan.pr_investment_plan | filter:filterByInvestment1">
                <td>{{$index+1}}</td>
                <td><input type="text" name="investment_item" required="" ng-model="item.investment_item" /></td>
                <td><input type="text" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="investment_cost_{{item.id}}" required ng-model="item.investment_cost"/></td>
                <td><input date-format type="date" name="investment_date" required="" ng-model="item.investment_date"/></td>
                <td ><input type="text" name="investment_detail" required="" ng-model="item.investment_detail"/></td>
                <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_investment_plan, item)" class="del">Хасах</a></td>
              </tr>
              <tr>
                <td></td>
                <td><a href="" ng-click="add_item_to_array(plan.pr_investment_plan, 'pr_investment_plan', 0)">Нэмэх<a></td>
                <td></td>
                <td></td>
                <td ></td>
              </tr>
              <tr>
                <td></td>
                <td >Эргэлтийн хөрөнгө</td>
                <td style="text-align: right;"></td>
                <td></td>
                <td ></td>
              </tr>
              <tr ng-repeat="item in plan.pr_investment_plan | filter:filterByInvestment2">
                <td>{{$index+1}}</td>
                <td><input type="text" name="investment_item" required="" ng-model="item.investment_item" /></td>
                <td><input type="text" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="investment_cost_{{item.id}}" required="" ng-model="item.investment_cost"/></td>
                <td><input date-format type="date" name="investment_date" required="" ng-model="item.investment_date"/></td>
                <td ><input type="text" name="investment_detail" required="" ng-model="item.investment_detail"/></td>
                <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_investment_plan, item)" class="del">Хасах</a></td>
              </tr>
              <tr>
                <td></td>
                <td><a href="" ng-click="add_item_to_array(plan.pr_investment_plan, 'pr_investment_plan', 1)">Нэмэх</a></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td></td>
                <td>Нийт хөрөнгө оруулалт</td>
                <td>₮{{sumOf(plan.pr_investment_plan, 'investment_cost', 0) | number:2}}</td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tfoot>
          </table>

          <br>
          <label class="subtitle">Компанийн хөрөнгө, өр авлага</label>
          <br>
          <hr>
          <table style="width: 800px; margin-top: 10px;">
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 30%">Хөрөнгө</td>
                <td style="width: 20%;">Хэмжээ</td>
                <td style="width: 30%">Өр</td>
                <td style="width: 20%">Хэмжээ</td>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="item in plan.pr_assets">
                <td>{{$index+1}}</td>
                <td><input type="text" name="asset_item" ng-model="item.asset_item" required="" /></td>
                <td><input type="text" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="asset_total_{{item.id}}" ng-model="item.asset_total" required="" /></td>
                <td><input type="text" name="asset_intend" ng-model="item.asset_intend" required="" /></td>
                <td><input type="text" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" name="asset_evaluation_{{item.id}}" ng-model="item.asset_evaluation" required="" /></td>
              </tr>
              <tr>
                <td></td>
                <td><a href="" ng-click="add_item_to_array(plan.pr_assets, 'pr_assets')">Нэмэх<a></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
        </table>
        </div>
          <ul class="form-list">
            <li>
              <button type="button" class="button red" ng-click="next(1,2)">БУЦАХ</button>
              <button type="submit" class="button">ЦААШ</button>
            </li>
          </ul>
      </form>

      <form id="form_3" hidden  ng-submit="next(4,3)">
        <label class="subtitle">Өрсөлдөгчийн судалгаа</label>
        <label class="righttitle">3/10</label>
        <br>
        <hr>
        <div class="formed">
        <table style="max-width: 1000px;">
          <thead>
            <tr>
              <td>#</td>
              <td style="width: 18%">Нэр</td>
              <td style="width: 17%;">Байршил</td>
              <td style="width: 10%">ЗЗ эзлэх хувь</td>
              <td style="width: 10%">Үнэ</td>
              <td style="width: 23%">Давуу тал</td>
              <td style="width: 22%">Сул тал</td>
              <td style=""></td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in plan.pr_competitors">
              <td>{{$index+1}}</td>
              <td><input type="text" name="competitor_name" required="" ng-model="item.competitor_name"/></td>
              <td><input type="text" name="competitor_location" required="" ng-model="item.competitor_location"/></td>
              <td><input type="number" name="competitor_percent" required="" ng-model="item.competitor_percent"/></td>
              <td ><input type="text" name="competitor_price_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required="" ng-model="item.competitor_price"/></td>
              <td ><input type="text" name="competitor_advantage" required="" ng-model="item.competitor_advantage"/></td>
              <td ><input type="text" name="competitor_weakness" required="" ng-model="item.competitor_weakness"/></td>
              <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_competitors, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_competitors, 'pr_competitors')">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td ></td>
            </tr>
          </tbody>
        </table>

        <br>
        <label class="subtitle">Нийлүүлэгчийн судалгаа</label>
        <br>
        <hr>
        <table style="margin-top:10px; max-width: 1300px;">
          <thead>
            <tr>
              <td>#</td>
              <td style="width: 18%">Нийлүүлэгч нэр</td>
              <td style="width: 15%;"><span>Түүхий эд</span></td>
              <td style="width: 8%"><span>Хэмжих нэгж</span></td>
              <td style="width: 12%"><span>Нэг удаагийн нийлүүлэх хэмжээ</span></td>
              <td style="width: 10%"><span>Хэр ойроос нийлүүлдэг</span></td>
              <td style="width: 10%"><span>Нэгжийн үнэ</span></td>
              <td style="width: 12%"><span>Үйлдвэрлэгчээс х.х зайд байдаг</span></td>
              <td style="width: 12%"><span>Тээврийн зардал</span></td>
              <td style="width: 5%"></td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in plan.pr_suppliers">
              <td>{{$index+1}}</td>
              <td><input type="text" name="supplier_name" required="" ng-model="item.supplier_name"/></td>
              <td><input type="text" name="supplier_item" required="" ng-model="item.supplier_item"/></td>
              <td>
                <select ng-model="item.supplier_unit">
                  <option value="1">ш</option>
                  <option value="2">л</option>
                  <option value="3">кг</option>
                  <option value="4">тн</option>
                </select>
              </td>
              <td ><input type="number" name="supplier_once_qty" required="" ng-model="item.supplier_once_qty"/></td>
              <td ><input type="number" name="supplier_how_near" required="" ng-model="item.supplier_how_near"/></td>
              <td ><input type="text" name="supplier_price_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required ng-model="item.supplier_price"/></td>
              <td ><input type="text" name="supplier_how_far_vendor" required="" ng-model="item.supplier_how_far_vendor"/></td>
              <td ><input type="text" name="supplier_transport_cost_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required ng-model="item.supplier_transport_cost"/></td>
              <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_suppliers, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_suppliers, 'pr_suppliers')">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td ></td>
            </tr>
          </tbody>
        </table>

        <br>
        <label class="subtitle">Зах зээлийн судалгаа</label>
        <br>
        <hr>
        <ul class="form-list">
          <li class="form-list__row form-list__row--inline">
            <div class="c2">
              <label>Зорилтот зах зээл</label>
              <input type="text" name="pr_target_market" required="" ng-model="plan.pr_target_market"/>
            </div>
            <div class="c1">
              <label>Хэрэглэгчдийн тоо</label>
              <input type="number" name="pr_client_count" required="" ng-model="plan.pr_client_count"/>
            </div>
            <div class="c1">
              <label>Өрсөлдөгчдийн тоо</label>
              <input type="number" name="pr_competitor_count" required="" ng-model="plan.pr_competitor_count"/>
            </div>
            <div class="c2">
            </div>
            <div class="c1">
            </div>
          </li>
        </ul>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(2,3)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>


      <form id="form_4" hidden  ng-submit="next(5,4)">
        <label class="subtitle">ДБСА-ийн шинжилгээ</label>
        <label class="righttitle">4/10</label>
        <br>
        <hr>
        <div class="formed">
        <table>
          <thead>
            <tr>
              <td style="width: 20%">Давуу тал (дотоод)</td>
              <td style="width: 18%;"><span>Сул тал (дотоод)</span></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><textarea type="text" name="pr_local_advatange" required rows="4" ng-model="plan.pr_local_advatange">{{plan.pr_local_advatange}}</textarea></td>
              <td><textarea type="text" name="pr_local_weakness" required rows="4" ng-model="plan.pr_local_weakness">{{plan.pr_local_weakness}}</textarea></td>
            </tr>
          </tbody>
          <thead>
            <tr>
              <td style="width: 20%">Боломж (гадаад)</td>
              <td style="width: 18%;"><span>Аюул (гадаад)</span></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><textarea type="text" name="pr_global_opportunity" required rows="4" ng-model="plan.pr_global_opportunity">{{plan.pr_global_opportunity}}</textarea></td>
              <td><textarea type="text" name="pr_global_dangerius" required rows="4" ng-model="plan.pr_global_dangerius">{{plan.pr_global_dangerius}}</textarea></td>
            </tr>
          </tbody>
        </table>


        <br>
        <label class="subtitle">Хэрэглэгчийн судалгаа</label>
        <br>
        <hr>
        <ul class="form-list">
          <li class="form-list__row form-list__row--inline">
            <div class="c1">
              <label>Дэлгэрэнгүй бичнэ үү</label>
              <textarea type="text" name="pr_client_survey" required rows="5" ng-model="plan.pr_client_survey">{{plan.pr_client_survey}}</textarea>
            </div>
            <div class="c1">

            </div>
          </li>
        </ul>
      </div>
          <ul class="form-list">
            <li>
              <button type="button" class="button red" ng-click="next(3,4)">БУЦАХ</button>
              <button type="submit" class="button">ЦААШ</button>
            </li>
          </ul>
      </form>


      <form id="form_5" hidden ng-submit="next(6,5)">
        <label class="subtitle">Эрсдлийн шинжилгээ ба менежмент</label>
        <label class="righttitle">5/10</label>
        <br>
        <hr>

        <div class="formed">
        <br>
        <table style="width: 800px;">
          <thead>
            <tr>
              <td>#</td>
              <td style="width: 30%">Үйл ажиллагаа</td>
              <td style="width: 35%;">Эрсдэл</td>
              <td style="width: 35%;">Буруулах арга зам</td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in plan.pr_risk_management">
              <td>{{$index+1}}</td>
              <td>{{item.risk_name}}</td>
              <td><textarea type="text" name="risk_detial" required rows="4" ng-model="item.risk_detial">{{item.risk_detial}}</textarea></td>
              <td><textarea type="text" name="risk_against" required rows="4" ng-model="item.risk_against">{{item.risk_against}}</textarea></td>
            </tr>
          </tbody>
        </table>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(4,5)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_6" hidden  ng-submit="next(7,6)">
        <label class="subtitle">Маркетингийн төлөвлөгөө</label>
        <label class="righttitle">6/10</label>
        <br>
        <hr>
        <div class="formed">
        <ul class="form-list">
          <li class="form-list__row form-list__row--inline">
            <div class="c2">
              <label>Бүтээгдэхүүн</label>
              <input type="text" name="pr_marketing_plan_product" required ng-model="plan.pr_marketing_plan_product"/>
            </div>
            <div class="c1">
              <label>Үнэ</label>
              <input type="text" name="pr_marketing_plan_price" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required ng-model="plan.pr_marketing_plan_price"></textarea>
            </div>
            <div class="c2">
              <label>Байршил түгээлт</label>
              <textarea type="text" name="pr_marketing_plan_distribution" required rows="5" ng-model="plan.pr_marketing_plan_distribution"></textarea>
            </div>
            <div class="c3">
              <label>Зар сурталчилгаа</label>
              <textarea type="text" name="pr_marketing_plan_reclam" required rows="5" ng-model="plan.pr_marketing_plan_reclam"></textarea>
            </div>
            <div class="c3">

            </div>
          </li>
        </ul>

        <label class="subtitle">Борлуулалт, борлуулалтын сувгууд</label>
        <br>
        <hr>
        <table style="width: 950px;">
          <tbody>
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 20%">Борлуулалтын цэг</td>
                <td style="width: 20%;">Байршил</td>
                <td style="width: 15%;">Борлуулалтын орлого</td>
                <td style="width: 15%;">Гэрээ байгуулсан эсэх</td>
                <td style="width: 12%;">Төлбөрийн хэлбэр</td>
                <td style="width: 23%;">Нөхцөл</td>
                <td style="width: 0%"></td>
              </tr>
            </thead>
            <tr ng-repeat="item in plan.pr_sales_sectors">
              <td>{{$index+1}}</td>
              <td><input type="text" required ng-model="item.sales_point_name"/></td>
              <td><input type="text" required ng-model="item.sales_point_location"/></td>
              <td><input type="text" required name="sales_point_income_{{item.id}}" ng-model="item.sales_point_income" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td>
                  <select ng-model="item.sales_point_iscontracted">
                    <option ng-value="1">Тийм</option>
                    <option ng-value="2">Үгүй</option>
                  </select>
              </td>
              <td>
                <select ng-model="item.sales_point_paymenttype">
                  <option ng-value="1">Бэлнээр</option>
                  <option ng-value="2">Бэлэн бусаар</option>
                </select>
              </td>
              <td><input type="text" required ng-model="item.sales_point_conditions"/></td>
              <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_sales_sectors, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_sales_sectors, 'pr_sales_sectors')">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <br>

        <label class="subtitle">Санхүүгийн төлөвлөгөөний дэлгэрэнгүй</label>
        <br>
        <hr>
        <ul class="form-list">
          <li class="form-list__row form-list__row--inline">
            <div class="c2">
              <label>Дэлгэрэнгүй өгүүлбэрээр бичнэ үү.</label>
              <textarea name="pr_finance_plan_detail" required rows="5" ng-model="plan.pr_finance_plan_detail">{{plan.pr_finance_plan_detail}}</textarea>
            </div>
            <div class="c2"></div>
          </li>
        </ul>
        </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(5,6)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_7" hidden ng-submit="next(8,7)">
        <label class="subtitle">Түүхий эд материалын зардал</label>
        <label class="righttitle">7/10</label>
        <br>
        <hr>
        <div class="formed">
          <ul class="form-list">
            <li class="form-list__row form-list__row--inline">
              <div class="c1">
                <label>Нэг жилд үнэ өсөх хувь</label>
                <input type="number" required  ng-model="plan.pr_production_price_increment_percent" ng-change="calc()"/>
              </div>
              <div class="c1">
                <label>Нийт бүтээгдэхүүний хэдэн хувь зарагдах</label>
                <input type="number" required  ng-model="plan.pr_production_sale_rate" ng-change="calc()"/>
              </div>
              <div class="c2">
              </div>
            </li>
          </ul>
          <div style="width: 100%; float:left; overflow: scroll; margin-bottom: 10px;">
            <table style="width: {{plan.pr_duration * 2100 / 5}}px !important;">
              <tbody>
                <thead>
                  <tr>
                    <td rowspan="2">#</td>
                    <td style="width: 10%" rowspan="2">Бүтээгдэхүүн</td>
                    <td style="width: 30%;" colspan="{{plan.pr_duration}}">Үйлдвэрлэх хэмжээ</td>
                    <td style="width: 30%;" colspan="{{plan.pr_duration}}">Нэгж үнэ</td>
                    <td style="width: 30%;" colspan="{{plan.pr_duration}}">Түүхий эдийн нийт өртөг</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                    <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                    <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                    <td></td>
                  </tr>
                </thead>
                <tr ng-repeat="item in plan.pr_raw_materials">
                  <td>{{$index+1}}</td>
                  <td><input type="text" required ng-model="item.raw_product"/></td>
                  <td ng-if="plan.pr_duration>=1">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="number" style="cursor:pointer;" name="raw_vol1_{{item.id}}" ng-click="addDetail('n', item.raw_vol1_details, item, 'raw_vol1_details', 'raw_vol1', item.raw_product)" required readonly ng-model="item.raw_vol1"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=2">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="number" style="cursor:pointer;" name="raw_vol2_{{item.id}}" ng-click="addDetail('n', item.raw_vol2_details, item, 'raw_vol2_details', 'raw_vol2', item.raw_product)" required readonly ng-model="item.raw_vol2"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=3">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="number" style="cursor:pointer;" name="raw_vol3_{{item.id}}" ng-click="addDetail('n', item.raw_vol3_details, item, 'raw_vol3_details', 'raw_vol3', item.raw_product)" required readonly ng-model="item.raw_vol3"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=4">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="number" style="cursor:pointer;" name="raw_vol4_{{item.id}}" ng-click="addDetail('n', item.raw_vol4_details, item, 'raw_vol4_details', 'raw_vol4', item.raw_product)" required readonly ng-model="item.raw_vol4"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=5">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="number" style="cursor:pointer;" name="raw_vol5_{{item.id}}" ng-click="addDetail('n', item.raw_vol5_details, item, 'raw_vol5_details', 'raw_vol5', item.raw_product)" required readonly ng-model="item.raw_vol5"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=1">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                    <input type="text" required name="raw_price1_{{item.id}}" readonly style="cursor: pointer" ng-click="addDetailItems(item.raw_price1_details, item, 'raw_price1_details', 'raw_price1', item.raw_product)" ng-model="item.raw_price1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=2">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                    <input type="text" required readonly name="raw_price2_{{item.id}}" readonly style="cursor: pointer" ng-click="addDetailItems(item.raw_price2_details, item, 'raw_price2_details', 'raw_price2', item.raw_product)" ng-model="item.raw_price2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=3">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                    <input type="text" required readonly name="raw_price3_{{item.id}}" readonly style="cursor: pointer" ng-click="addDetailItems(item.raw_price3_details, item, 'raw_price3_details', 'raw_price3', item.raw_product)" ng-model="item.raw_price3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=4">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="text" required readonly name="raw_price4_{{item.id}}" readonly style="cursor: pointer" ng-click="addDetailItems(item.raw_price4_details, item, 'raw_price4_details', 'raw_price4', item.raw_product)" ng-model="item.raw_price4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=5">
                    <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                      <input type="text" required readonly name="raw_price5_{{item.id}}" readonly style="cursor: pointer" ng-click="addDetailItems(item.raw_price5_details, item, 'raw_price5_details', 'raw_price5', item.raw_product)" ng-model="item.raw_price5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                    </div>
                  </td>
                  <td ng-if="plan.pr_duration>=1"><input type="text" required name="raw_cost1_{{item.id}}" readonly ng-model="item.raw_cost1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                  <td ng-if="plan.pr_duration>=2"><input type="text" required name="raw_cost2_{{item.id}}" readonly ng-model="item.raw_cost2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                  <td ng-if="plan.pr_duration>=3"><input type="text" required name="raw_cost3_{{item.id}}" readonly ng-model="item.raw_cost3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                  <td ng-if="plan.pr_duration>=4"><input type="text" required name="raw_cost4_{{item.id}}" readonly ng-model="item.raw_cost4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                  <td ng-if="plan.pr_duration>=5"><input type="text" required name="raw_cost5_{{item.id}}" readonly ng-model="item.raw_cost5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                  <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_raw_materials, item)" class="del">Хасах</a></td>
                </tr>
                <tr>
                  <td></td>
                  <td><a href="" ng-click="add_item_to_array(plan.pr_raw_materials, 'pr_raw_materials')">Нэмэх<a></td>
                  <td></td>
                  <td></td>
                  <td ></td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td></td>
                  <td>Нийт</td>
                  <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{sumOf(plan.pr_raw_materials, 'raw_vol', $index+1) | number : 2}}</td>
                  <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration"></td>
                  <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) | number : 2}}</td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
          <br>
          <br>
          <label class="subtitle" style="width:100%; margin-bottom: 10px; margin-top: 10px;">Үйлдвэрлэл, борлуулалтын төлөвлөгөө</label>
          <br>
          <hr>
          <br>

          <div style="width: 100%; float:left; overflow: scroll; margin-bottom: 10px;">
            <table style="width: {{plan.pr_duration * 2100 / 5}}px !important;">
              <tbody>
              <thead>
              <tr>
                <td rowspan="2">#</td>
                <td style="width: 10%" rowspan="2">Бүтээгдэхүүн</td>
                <td style="width: 6%;" rowspan="2">Хэмжих нэгж</td>
                <td style="width: 28%;" colspan="{{plan.pr_duration}}">Борлуулах хэмжээ</td>
                <td style="width: 28%;" colspan="{{plan.pr_duration}}">Нэгжийн үнэ</td>
                <td style="width: 28%;" colspan="{{plan.pr_duration}}">Борлуулалтын орлого</td>
                <td></td>
              </tr>
              <tr>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                <td></td>
              </tr>
              </thead>
              <tr ng-repeat="item in plan.pr_productions">
                <td>{{$index+1}}</td>
                <td><input type="text" required ng-model="item.production_product_name"/></td>
                <td>
                  <select ng-model="item.production_product_unit">
                    <option value="1">ш</option>
                    <option value="2">л</option>
                    <option value="3">кг</option>
                    <option value="4">тн</option>
                  </select>
                </td>
                <td ng-if="plan.pr_duration>=1">
<!--                    <input type="number" style="cursor:pointer;" name="production_vol1_{{item.id}}" ng-click="addDetail('n', item.production_vol1_details, item, 'production_vol1_details', 'production_vol1')" required readonly ng-model="item.production_vol1"/>-->

                    <input type="number" style="cursor:pointer;" name="production_vol1_{{item.id}}" required readonly ng-model="item.production_vol1"/>
                </td>
                <td ng-if="plan.pr_duration>=2">
                  <input type="number" style="cursor:pointer;" name="production_vol2_{{item.id}}" required readonly ng-model="item.production_vol2"/>
                </td>
                <td ng-if="plan.pr_duration>=3">
                  <input type="number" style="cursor:pointer;" name="production_vol3_{{item.id}}" required readonly ng-model="item.production_vol3"/>
                </td>
                <td ng-if="plan.pr_duration>=4">
                  <input type="number" style="cursor:pointer;" name="production_vol4_{{item.id}}" required readonly ng-model="item.production_vol4"/>
                </td>
                <td ng-if="plan.pr_duration>=5">
                  <input type="number" style="cursor:pointer;" name="production_vol5_{{item.id}}" required readonly ng-model="item.production_vol5"/>
                </td>
                <td ng-if="plan.pr_duration>=1">
                  <input type="text" required name="production_price1_{{item.id}}" ng-keyup="value(item, 'production_price1', 'production_price2', 'production_price3', 'production_price4', 'production_price5', 'production_vol,production_income', 'pr_production_price_increment_percent', 'pr_production_sale_rate')" ng-model="item.production_price1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=2">
                  <input type="text" required readonly name="production_price2_{{item.id}}" ng-model="item.production_price2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=3">
                  <input type="text" required readonly name="production_price3_{{item.id}}" ng-model="item.production_price3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=4">
                  <input type="text" required readonly name="production_price4_{{item.id}}" ng-model="item.production_price4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=5">
                  <input type="text" required readonly name="production_price5_{{item.id}}" ng-model="item.production_price5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=1">
                  <input type="text" required readonly name="production_income1_{{item.id}}" ng-model="item.production_income1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=2">
                  <input type="text" required readonly name="production_income2_{{item.id}}" ng-model="item.production_income2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=3">
                  <input type="text" required readonly name="production_income3_{{item.id}}" ng-model="item.production_income3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=4">
                  <input type="text" required readonly name="production_income4_{{item.id}}" ng-model="item.production_income4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td ng-if="plan.pr_duration>=5">
                  <input type="text" required readonly name="production_income5_{{item.id}}" ng-model="item.production_income5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/>
                </td>
                <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_productions, item)" class="del">Хасах</a></td>
              </tr>
              <tr>
                <td></td>
                <td><a href="" ng-click="add_item_to_array(plan.pr_productions, 'pr_productions')">Нэмэх<a></td>
                <td></td>
                <td></td>
                <td ></td>
              </tr>
              </tbody>
              <tfoot>
              <tr>
                <td></td>
                <td>Нийт</td>
                <td></td>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{sumOf(plan.pr_productions, 'production_vol', $index+1) | number : 2}}</td>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration"></td>
                <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_productions, 'production_income', $index+1) | number : 2}}</td>
                <td></td>
              </tr>
              </tfoot>
            </table>
          </div>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(6,7)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_8" hidden ng-submit="next(9,8)">
        <label class="subtitle">Цалингийн зардал</label>
        <label class="righttitle">8/10</label><br>
        <hr>
        <div class="formed">
        <br>
        <div style="overflow: scroll; width: 100%">
          <table style="width: {{plan.pr_duration * 1800 / 5}}px;">
          <tbody>
            <thead>
              <tr>
                <td rowspan="2">#</td>
                <td style="width: 20%" rowspan="2">Албар тушаал</td>
                <td style="width: {{80/plan.pr_duration}}%;" colspan="2" ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                <td style=""></td>
              </tr>
              <tr>
                <td ng-if="plan.pr_duration>=1">Сараар</td>
                <td ng-if="plan.pr_duration>=1">Жилээр</td>
                <td ng-if="plan.pr_duration>=2">Сараар</td>
                <td ng-if="plan.pr_duration>=2">Жилээр</td>
                <td ng-if="plan.pr_duration>=3">Сараар</td>
                <td ng-if="plan.pr_duration>=3">Жилээр</td>
                <td ng-if="plan.pr_duration>=4">Сараар</td>
                <td ng-if="plan.pr_duration>=4">Жилээр</td>
                <td ng-if="plan.pr_duration>=5">Сараар</td>
                <td ng-if="plan.pr_duration>=5">Жилээр</td>
                <td></td>
              </tr>
            </thead>
            <tr>
              <td></td>
              <td colspan="{{(plan.pr_duration+1)*2}}" style="text-align: left !important;">Одоо байгаа</td>
            </tr>
            <tr ng-repeat="item in plan.pr_salary_costs | filter:filterBySalaryType1">
                <td>{{$index+1}}</td>
                <td><input type="text" required ng-model="item.salary_person"/></td>
                <td ng-if="plan.pr_duration>=1"><input type="text" required name="salary_month1_{{item.id}}" readonly ng-model="item.salary_month1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=1"><input type="text" required name="salary_year1_{{item.id}}"  style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year1_details, item, 'salary_year1_details', 'salary_year1')" ng-model="item.salary_year1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=2"><input type="text" required name="salary_month2_{{item.id}}" readonly ng-model="item.salary_month2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=2"><input type="text" required name="salary_year2_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year2_details, item, 'salary_year2_details', 'salary_year2')" ng-model="item.salary_year2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=3"><input type="text" required name="salary_month3_{{item.id}}" readonly ng-model="item.salary_month3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=3"><input type="text" required name="salary_year3_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year3_details, item, 'salary_year3_details', 'salary_year3')" ng-model="item.salary_year3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=4"><input type="text" required name="salary_month4_{{item.id}}" readonly ng-model="item.salary_month4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=4"><input type="text" required name="salary_year4_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year4_details, item, 'salary_year4_details', 'salary_year4')" ng-model="item.salary_year4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=5"><input type="text" required name="salary_month5_{{item.id}}" readonly ng-model="item.salary_month5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=5"><input type="text" required name="salary_year5_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year5_details, item, 'salary_year5_details', 'salary_year5')" ng-model="item.salary_year5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_salary_costs, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_salary_costs, 'pr_salary_costs', 0)">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td></td>
              <td colspan="{{(plan.pr_duration+1)*2}}" style="text-align: left !important;">Шинээр авах</td>
            </tr>
            <tr ng-repeat="item in plan.pr_salary_costs | filter:filterBySalaryType2">
                <td>{{$index+1}}</td>
                <td><input type="text" required ng-model="item.salary_person"/></td>
                <td ng-if="plan.pr_duration>=1"><input type="text" required name="salary_month1_{{item.id}}" readonly ng-model="item.salary_month1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=1"><input type="text" required name="salary_year1_{{item.id}}"  style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year1_details, item, 'salary_year1_details', 'salary_year1')" ng-model="item.salary_year1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=2"><input type="text" required name="salary_month2_{{item.id}}" readonly ng-model="item.salary_month2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=2"><input type="text" required name="salary_year2_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year2_details, item, 'salary_year2_details', 'salary_year2')" ng-model="item.salary_year2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=3"><input type="text" required name="salary_month3_{{item.id}}" readonly ng-model="item.salary_month3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=3"><input type="text" required name="salary_year3_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year3_details, item, 'salary_year3_details', 'salary_year3')" ng-model="item.salary_year3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=4"><input type="text" required name="salary_month4_{{item.id}}" readonly ng-model="item.salary_month4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=4"><input type="text" required name="salary_year4_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year4_details, item, 'salary_year4_details', 'salary_year4')" ng-model="item.salary_year4" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=5"><input type="text" required name="salary_month5_{{item.id}}" readonly ng-model="item.salary_month5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td ng-if="plan.pr_duration>=5"><input type="text" required name="salary_year5_{{item.id}}"  readonly style="cursor: pointer" readonly ng-click="addDetailSal(item.salary_year5_details, item, 'salary_year5_details', 'salary_year5')" ng-model="item.salary_year5" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
                <td><a href="" ng-show="$index>=0" ng-click="remove_item_to_array(plan.pr_salary_costs, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_salary_costs, 'pr_salary_costs', 1)">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td></td>
              <td>Нийт</td>
              <td ng-if="plan.pr_duration>=1">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 1) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=1">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 1) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=2">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 2) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=2">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 2) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=3">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 3) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=3">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 3) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=4">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 4) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=4">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 4) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=5">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 5) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=5">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 5) | number : 2}}</td>
              <td></td>
            </tr>
            <tr>
              <td></td>
              <td>НДШ,ЭМД</td>
              <td ng-if="plan.pr_duration>=1">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 1)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=1">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 1)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=2">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 2)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=2">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 2)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=3">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 3)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=3">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 3)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=4">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 4)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=4">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 4)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=5">₮{{sumOf(plan.pr_salary_costs, 'salary_month', 5)*0.19 | number : 2}}</td>
              <td ng-if="plan.pr_duration>=5">₮{{sumOf(plan.pr_salary_costs, 'salary_year', 5)*0.19 | number : 2}}</td>
              <td></td>
            </tr>
          </tfoot>
        </table>
        </div>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(7,8)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_9" hidden ng-submit="next(10,9)">
        <label class="subtitle">Элэгдлийн зардал</label>
        <label class="righttitle">9/10</label><br>
        <hr>
        <div class="formed">
        <br>
        <table style="width: 800px;">
          <tbody>
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 30%">Байр ба тоног төхөөрөмж</td>
                <td style="width: 20%;">Нийт үнэлгээ</td>
                <td style="width: 15%;">Жилийн хорогдолын хувь</td>
                <td style="width: 15%;">Жилийн хорогдол</td>
                <td style="width: 15%;">Сарын хорогдол</td>
                <td style="width: 5%;"></td>
              </tr>
            </thead>
            <tr>
              <td></td>
              <td colspan="6" style="text-align: left !important;">Одоо байгаа</td>
            </tr>
            <tr ng-repeat="item in plan.pr_depreciation_costs | filter: filterByDepreciationCost1">
              <td>{{$index+1}}</td>
              <td><input type="text" required ng-model="item.depreciation_item"/></td>
              <td><input type="text" required name="depreciation_total_{{item.id}}" ng-model="item.depreciation_total" ng-change="valueDep(item, 'depreciation_total','depreciation_cost_year_percent','depreciation_cost_year','depreciation_cost_month')" ng-change="valueDep(item, 'depreciation_total','depreciation_cost_year_percent','depreciation_cost_year_percentdepreciation_cost_year_percent','depreciation_cost_month')" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><input type="number" required name="depreciation_cost_year_percent_{{item.id}}" ng-model="item.depreciation_cost_year_percent"
                         ng-change="valueDep(item, 'depreciation_total','depreciation_cost_year_percent','depreciation_cost_year','depreciation_cost_month')"/></td>
              <td><input type="text" required readonly name="depreciation_cost_year_{{item.id}}" ng-model="item.depreciation_cost_year" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><input type="text" required readonly name="depreciation_cost_month_{{item.id}}" ng-model="item.depreciation_cost_month" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_depreciation_costs, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_depreciation_costs, 'pr_depreciation_costs', 0)">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td></td>
              <td colspan="6" style="text-align: left !important;">Бизнес төлөвлөгөөг хэрэгжүүлэх үед шинээр худалдан авах</td>
            </tr>
            <tr ng-repeat="item in plan.pr_depreciation_costs | filter: filterByDepreciationCost2">
              <td>{{$index+1}}</td>
              <td><input type="text" required ng-model="item.depreciation_item"/></td>
              <td><input type="text" required name="depreciation_total_{{item.id}}" ng-model="item.depreciation_total" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><input type="number" required ng-model="item.depreciation_cost_year_percent"/></td>
              <td><input type="text" required name="depreciation_cost_year_{{item.id}}" ng-model="item.depreciation_cost_year" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><input type="text" required name="depreciation_cost_month_{{item.id}}" ng-model="item.depreciation_cost_month" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
              <td><a href="" ng-show="$index>=0" ng-click="remove_item_to_array(plan.pr_depreciation_costs, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_depreciation_costs, 'pr_depreciation_costs', 1)">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td ></td>
            </tr>
          </tbody>
          <tfoot>
          <tr>
            <td></td>
            <td>Нийт</td>
            <td>₮{{sumOf(plan.pr_depreciation_costs, 'depreciation_total', 0) | number : 2}}</td>
            <td></td>
            <td>₮{{sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) | number : 2}}</td>
            <td>₮{{sumOf(plan.pr_depreciation_costs, 'depreciation_cost_month', 0) | number : 2}}</td>
            <td></td>
          </tr>
          </tfoot>
        </table>

        <br>
        <label class="subtitle">Бусад зардал</label>
          <br>
        <hr>
        <br>
        <table style="width: {{plan.pr_duration * 900 / 5}}px;">
          <tbody>
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 15%">Зардлууд</td>
                <td style="width: {{85/plan.pr_duration}}%;" ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
                <td></td>
              </tr>
            </thead>
            <tr ng-repeat="item in plan.pr_other_costs">
              <td>{{$index+1}}</td>
              <td><input type="text" required ng-model="item.other_costs_item"/></td>
              <td ng-if="plan.pr_duration>=1">
                <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                  <input type="text" style="cursor:pointer;" name="other_costs_cost1_{{item.id}}" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-click="addDetail('c', item.other_costs_cost1_details, item, 'other_costs_cost1_details', 'other_costs_cost1', item.other_costs_item)" required readonly ng-model="item.other_costs_cost1"/>
                </div>
              </td>
              <td ng-if="plan.pr_duration>=2">
                <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                  <input type="text" style="cursor:pointer;" name="other_costs_cost2_{{item.id}}" required readonly npattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-click="addDetail('c', item.other_costs_cost2_details, item, 'other_costs_cost2_details', 'other_costs_cost2', item.other_costs_item)" required readonly ng-model="item.other_costs_cost2"/>
                </div>
              </td>
              <td ng-if="plan.pr_duration>=3">
                <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                  <input type="text" style="cursor:pointer;" name="other_costs_cost3_{{item.id}}" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-click="addDetail('c', item.other_costs_cost3_details, item, 'other_costs_cost3_details', 'other_costs_cost3', item.other_costs_item)" required readonly ng-model="item.other_costs_cost3"/>
                </div>
              </td>
              <td ng-if="plan.pr_duration>=4">
                <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                  <input type="text" style="cursor:pointer;" name="other_costs_cost4_{{item.id}}" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-click="addDetail('c', item.other_costs_cost4_details, item, 'other_costs_cost4_details', 'other_costs_cost4', item.other_costs_item)" required readonly ng-model="item.other_costs_cost4"/>
                </div>
              </td>
              <td ng-if="plan.pr_duration>=5">
                <div data-tip="Энд дарж дэлгэнрэнгүй оруулна уу !">
                  <input type="text" style="cursor:pointer;" name="other_costs_cost5_{{item.id}}" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-click="addDetail('c', item.other_costs_cost5_details, item, 'other_costs_cost5_details', 'other_costs_cost5', item.other_costs_item)" required readonly ng-model="item.other_costs_cost5"/>
                </div>
              </td>

<!--              <td><input type="text" required name="other_costs_cost1_{{item.id}}" ng-model="item.other_costs_cost1" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>-->
<!--              <td><input type="text" required name="other_costs_cost2_{{item.id}}" ng-model="item.other_costs_cost2" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>-->
<!--              <td><input type="text" required name="other_costs_cost3_{{item.id}}" ng-model="item.other_costs_cost3" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>-->
              <td><a href="" ng-show="$index>=1" ng-click="remove_item_to_array(plan.pr_other_costs, item)" class="del">Хасах</a></td>
            </tr>
            <tr>
              <td></td>
              <td><a href="" ng-click="add_item_to_array(plan.pr_other_costs, 'pr_other_costs')">Нэмэх<a></td>
              <td></td>
              <td></td>
              <td ></td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td></td>
              <td>Нийт</td>
              <td ng-if="plan.pr_duration>=1">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', 1) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=2">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', 2) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=3">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', 3) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=4">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', 4) | number : 2}}</td>
              <td ng-if="plan.pr_duration>=5">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', 5) | number : 2}}</td>
              <td></td>
            </tr>
          </tfoot>
        </table>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(8,9)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_10" hidden ng-submit="next(11,10)">
        <label class="subtitle">Зээлийн мэдээлэл, хуваарь</label>
        <label class="righttitle">10/10</label><br>
        <hr>
        <div class="formed">

        <ul class="form-list">
          <li class="form-list__row form-list__row--inline">
            <div class="c2">
              <label>Байгууллагын нэр</label>
              <input type="text" name="pr_loan_org_name" required="" ng-model="plan.pr_loan_org_name"/>
            </div>
            <div class="c1">
              <label>Зээлийн хэжмээ</label>
              <input type="text" name="pr_loan_amount"  pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required ng-model="plan.pr_loan_amount"/>
            </div>
            <div class="c1">
              <label>Зээлийн хүү</label>
              <input type="number" pattern="^\d*(\.\d{0,2})?$" min="0" value="0" step="0.01"name="pr_loan_rate" required ng-model="plan.pr_loan_rate"/>
            </div>
            <div class="c1">
              <label>Хугацаа/сараар/</label>
              <input type="number" name="pr_loan_duration" required ng-model="plan.pr_loan_duration"/>
            </div>
            <div class="c1">
              <label>Эхлэх өдөр</label>
              <input type="date" name="pr_loan_start_date" required="" ng-model="plan.pr_loan_start_date"/>
            </div>
            <div class="c1">
            </div>
            <div class="c3">
            </div>
            <div class="c1">
            </div>
          </li>
        </ul>

        <button type="button" class="button" style="margin-top: 0px; margin-bottom: 10px;" ng-click="calcLoan()">ТООЦООЛОХ</button>
        <table style="width: 700px;">
          <tbody>
            <thead>
              <tr>
                <td>#</td>
                <td style="width: 20%">Огноо</td>
                <td style="width: 10%;">Хоног</td>
                <td style="width: 20%;">Хүүгийн төлбөр</td>
                <td style="width: 25%;">Зээлийн төлбөр</td>
                <td style="width: 25%;">Зээлийн үлдэгдэл</td>
              </tr>
            </thead>
            <tr ng-repeat="item in plan.pr_loan_dates">
              <td>{{$index+1}}</td>
              <td>{{item.loan_date.substring(0,10)}}</td>
              <td><input type="number" readonly required ng-model="item.loan_day"/></td>
              <td><input type="text" readonly name="loan_rate_amount_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" required ng-model="item.loan_rate_amount"/></td>
              <td><input type="text" readonly name="loan_amount_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" required ng-model="item.loan_amount"/></td>
              <td><input type="text" readonly name="loan_balance_{{item.id}}" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" required ng-model="item.loan_balance"/></td>
            </tr>
          </tbody>
          <tfoot>
            <tr ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration && sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date') > 0">
              <td></td>
              <td>Нийт {{number}}</td>
              <td></td>
              <td>₮{{sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date') | number:2}}</td>
              <td>₮{{sumOfCheck(plan.pr_loan_dates, 'loan_amount', number, 'loan_date') | number:2}}</td>
            </tr>
            <tr>
              <td></td>
              <td>Нийт бүгд</td>
              <td></td>
              <td>₮{{sumOf(plan.pr_loan_dates, 'loan_rate_amount', 0) | number:2}}</td>
              <td>₮{{sumOf(plan.pr_loan_dates, 'loan_amount', 0) | number:2}}</td>
            </tr>
          </tfoot>
        </table>
      </div>
        <ul class="form-list">
          <li>
            <button type="button" class="button red" ng-click="next(9,10)">БУЦАХ</button>
            <button type="submit" class="button">ЦААШ</button>
          </li>
        </ul>
      </form>

      <form id="form_11" hidden>
        <label class="subtitle">Таны бизнес төлөвлөгөөний үр дүн</label>
        <br>
        <hr>
        <p>{{planResponse.msg}}</p>
        <button type="button" class="button red" ng-click="next(10, 11)">БУЦАХ</button>
        <button type="button" class="button" ng-click="planSave()">ХАДГАЛАХ</button>

        <div class="formed" id="html">
          <style type="text/css">
            table.normal {
              border-collapse: separate;
                width: 100%;
              border-spacing: 0px;
                flex-direction: column;
              border-radius: 0px !important;
            }
            table.normal td {
              vertical-align: top;
              padding: 5px !important;
              text-transform: none;
            }

            b {
              width: 100%;
              display: block;
            }

        </style>

          <table class="normal" style="width: 700px;">
            <tr>
              <td style="width: 30%;"></td>
              <td style="width: {{70/plan.pr_duration}}%}}" ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">{{number}}</td>
            </tr>
            <tr>
              <td><strong>Нийт борлуулалт</strong></td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_productions, 'production_income', $index+1) | number:2}}</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;Борлуулалтын орлого</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_productions, 'production_income', $index+1) | number:2}}</td>
            </tr>
            <tr>
              <td><strong>Нийт зардал</strong></td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{
                  sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                  sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                  sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                  sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                  sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date') +
                  sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19 | number:2
                }}
              </td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;Түүхийн эдийн зардал</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) | number:2}}</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;Ажилчдын цалин</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_salary_costs, 'salary_year', $index+1) | number:2}}</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;НДШ, ЭМД</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19 | number:2}}
              </td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;Элэгдлийн зардал</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) | number:2}}</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;Бусад зардал</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) | number:2}}</td>
            </tr>
            <tr>
              <td>Зээлийн хүү</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date') | number:2}}</td>
            </tr>
            <tr>
              <td><strong>Нийт ашиг</strong></td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{
                sumOf(plan.pr_productions, 'production_income', $index+1) -
                (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19) | number:2
                }}
              </td>
            </tr>
            <tr>
              <td>Орлогын татвар</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{
                (sumOf(plan.pr_productions, 'production_income', $index+1) -
                (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                        sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                        sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                        sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19))*0.1 | number:2
                }}
              </td>
            </tr>
            <tr>
              <td><strong>Цэвэр ашиг</strong></td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{
                (sumOf(plan.pr_productions, 'production_income', $index+1) -
                (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                        sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                        sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                        sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19))
                -
                (sumOf(plan.pr_productions, 'production_income', $index+1) -
                (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                        sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                        sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                        sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                        sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19)*0.1)
                | number:2
                }}
              </td>
            </tr>
            <tr>
              <td>Зээлийн эргэн төлөлт</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">₮{{sumOfCheck(plan.pr_loan_dates, 'loan_amount', number, 'loan_date') | number:2}}</td>
            </tr>
            <tr>
              <td><strong>Зээлийн эргэн төлөлтийн дараах ашиг</strong></td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">
                ₮{{
                (sumOf(plan.pr_productions, 'production_income', $index+1) -
                        (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                                sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                                sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                                sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                                sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                                sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19))
                -
                (sumOf(plan.pr_productions, 'production_income', $index+1) -
                        (sumOf(plan.pr_raw_materials, 'raw_cost', $index+1) +
                                sumOf(plan.pr_salary_costs, 'salary_year', $index+1) +
                                sumOf(plan.pr_depreciation_costs, 'depreciation_cost_year', 0) +
                                sumOf(plan.pr_other_costs, 'other_costs_cost', $index+1) +
                                sumOfCheck(plan.pr_loan_dates, 'loan_rate_amount', number, 'loan_date')+
                                sumOf(plan.pr_salary_costs, 'salary_year', $index+1)*0.19)*0.1)
                -
                sumOfCheck(plan.pr_loan_dates, 'loan_amount', number, 'loan_date')
                | number:2}}
              </td>
            </tr>
            <tr>
              <td>Бэлэн мөнгөний эцсийн үлдэгдэл</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">

              </td>
            </tr>
            <tr>
              <td>Энэ хугацааны бэлэн мөнгөний хамгийн бага үлдэгдэл</td>
              <td ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration">

              </td>
            </tr>
          </table>
          <br><br>
          <table style="width: 1500px;">
            <tr>
              <td style="width: 10%;">Үзүүлэлт</td>
              <td colspan="12" style="width: 90%" ng-repeat="number in [year,year+1,year+2,year+3,year+4,year+5]" ng-if="$index < plan.pr_duration && $index < 1">
                  {{number}}
              </td>
            </tr>
            <tr>
              <td style="width: 10%;"></td>
              <td  style="width: {{90/12}}%" ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
                {{number}}
              </td>
            </tr>
            <tr>
              <td>Бэлэн мөнгөний эхний үлдэгдэл</td>
              <td ng-repeat="rows in plan.pr_cash_list[0].cash1_details">
                <input type="text" required pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" ng-model="rows.m"/>
              </td>
<!--              <td ng-repeat="month in plan.pr_cash_list[0].cash2_details">-->
<!--                <input type="text" style="cursor:pointer;" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required readonly ng-model="month.m"/>-->
<!--              </td>-->
<!--              <td ng-repeat="month in plan.pr_cash_list[0].cash3_details">-->
<!--                <input type="text" style="cursor:pointer;" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required readonly ng-model="month.m"/>-->
<!--              </td>-->
<!--              <td ng-repeat="month in plan.pr_cash_list[0].cash4_details">-->
<!--                <input type="text" style="cursor:pointer;" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required readonly ng-model="month.m"/>-->
<!--              </td>-->
<!--              <td ng-repeat="month in plan.pr_cash_list[0].cash5_details">-->
<!--                <input type="text" style="cursor:pointer;" required readonly pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000" required readonly ng-model="month.m"/>-->
<!--              </td>-->
            </tr>
            <tr>
              <td>Орлого бэлэн мөнгөөр</td>
              <td>
              </td>
            </tr>
            <tr>
              <td>Борлуулалтын орлого</td>
              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
                {{sumOfM(plan.pr_raw_materials, 'raw_vol', 1, number)*plan.pr_production_sale_rate*plan.pr_productions[0].production_price1 | number:2}}
              </td>
<!--              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">-->
<!--                {{sumOfM(plan.pr_raw_materials, 'raw_vol', 2, number)*plan.pr_production_sale_rate*plan.pr_productions[0].production_price2 | number:2}}-->
<!--              </td>-->
<!--              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">-->
<!--                {{sumOfM(plan.pr_raw_materials, 'raw_vol', 3, number)*plan.pr_production_sale_rate*plan.pr_productions[0].production_price3 | number:2}}-->
<!--              </td>-->
<!--              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">-->
<!--                {{sumOfM(plan.pr_raw_materials, 'raw_vol', 4, number)*plan.pr_production_sale_rate*plan.pr_productions[0].production_price4 | number:2}}-->
<!--              </td>-->
<!--              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">-->
<!--                {{sumOfM(plan.pr_raw_materials, 'raw_vol', 5, number)*plan.pr_production_sale_rate*plan.pr_productions[0].production_price5 | number:2}}-->
<!--              </td>-->
            </tr>
            <tr>
              <td>Банкны зээл</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Өөрийн хөрөнгө оруулалт
              </td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Нийт мөнгөн орлого</td>
              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
                {{(sumOfM(plan.pr_raw_materials, 'raw_vol', 1, number) * plan.pr_production_sale_rate *
              plan.pr_productions[0].production_price1 + sumOfM(plan.pr_cash_list, 'cash', 1, number)) | number:2}}

                {{sumOfM(plan.pr_cash_list, 'cash', 1, number)}}
              </td>
            </tr>
            <tr>
              <td>Хөрөнгө оруулалтын зардал</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Тоног төхөөрөмж</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Үйлдвэрлэл, удирдлагын зардал
              </td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Түүхий эдийн зардал</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Ажилчдын цалин</td>
              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
                ₮{{sumOfA(plan.pr_salary_costs, 'salary_year', 1, number) | number:2}}
              </td>
            </tr>
            <tr>
              <td>Эрүүл мэнд нийгмийн даатгал</td>
              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
                ₮{{sumOfA(plan.pr_salary_costs, 'salary_year', 1, number)*0.19 | number:2}}
              </td>
            </tr>
            <tr>
              <td>Зээлийн хүү төлөлт</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Зээл төлөлт</td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Орлогын албан татвар
              </td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Бусад зардал
              </td>
              <td ng-repeat="number in [1,2,3,4,5,6,7,8,9,10,11,12]">
<!--                ₮{{sumOfM(plan.pr_other_costs, 'other_costs_cost', 1, number) | number:2}}-->
              </td>
            </tr>
            <tr>
              <td>Нийт мөнгөн зардал
              </td>
              <td>

              </td>
            </tr>
            <tr>
              <td>Бэлэн мөнгөний эцсийн үлдэгдэл
              </td>

            </tr>
          </table>
          <br><br>
          <table class="normal" >
            <tr>
              <td style="width: 30%;">Төсөл хэрэгжүүлэх&nbsp;хугацаа</td>
              <td style="width: 70%;">{{durationRender(plan.pr_duration)}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Төслийн нэр</td>
              <td style="width: 70%;">{{plan.pr_name}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Санхүүжүүлэгч байгууллага</td>
              <td style="width: 70%;">{{plan.pr_fund_org}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Төсөл хэрэгжүүлэгчийн нэр</td>
              <td style="width: 70%;">{{plan.pr_owner_name}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Төсөв(нийт) Үүнээс:<br>-Санхүүжүүлэгчээс<br>-Өөрөөс</td>
              <td style="width: 70%;">₮ {{plan.pr_budget_total | number:2}}<br>₮ {{plan.pr_budget_funder | number:2}}<br>₮ {{plan.pr_budget_me | number:2}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Зорилго</td>
              <td style="width: 70%;">{{plan.pr_purpose}}</td>
            </tr>
            <tr>
              <td style="width: 30%;">Хүлээгдэж буй үр дүн</td>
              <td style="width: 70%;">{{plan.pr_expected_result}}</td>
            </tr>
          </table>
          <br>
          <b>1. Бизнесийн танилцуулга</b>
          <p>{{plan.pr_business_detail}}</p>

          <b>2. Төслийн үндэслэл</b>
          <p>{{plan.pr_grounds}}</p>

          <b>3. Хөрөнгө оруулалтын төлөвлөгөө</b>
          <table class="normal">
            <tr>
              <td></td>
              <td style="width: 25%;"><strong>Зүйл</strong></td>
              <td style="width: 25%;"><strong>Зардал</strong></td>
              <td style="width: 25%;"><strong>Огноо</strong></td>
              <td style="width: 25%;"><strong>Тайлбар</strong></td>
            </tr>
            <tr ng-repeat="item in plan.pr_investment_plan">
              <td>{{$index+1}}</td>
              <td style="width: 25%;">{{item.investment_item}}</td>
              <td style="width: 25%;">₮ {{item.investment_cost | number:2}}</td>
              <td style="width: 25%;">{{item.investment_date}}</td>
              <td style="width: 25%;">{{item.investment_detail}}</td>
            </tr>
          </table>
        </div>
      </form>

    </div> <!-- END: .modal__content -->
  </div> <!-- END: .modal__container -->
</div> <!-- END: .modal -->

  <div id="dialog" title="Задаргаа оруулах" class="modal-body">
    <p>Та сонгосон мөрний дэлгэрэнгүй мэдээлэлүүдийг оруулна уу.</p>
    <b>Нийлбэр : {{total | number: 2}} ({{subTitle}})</b>
    <br>
    <table>
      <tr>
        <td>
          I улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=0 && $index<=2">
              <td>{{$index+1}}</td>
              <td ng-if="format=='n'"><input type="number" required ng-model="item.m" placeholder="{{$index+1}}-р сар"/></td>
              <td ng-if="format=='c'"><input type="text" required id="field_{{$index}}" ng-model="item.m" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
            </tr>
          </table>
        </td>
        <td>
          III улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=3 && $index<=5">
              <td>{{$index+1}}</td>
              <td ng-if="format=='n'"><input type="number" required ng-model="item.m" placeholder="{{$index+1}}-р сар"/></td>
              <td ng-if="format=='c'"><input type="text" id="field_{{$index}}" required ng-model="item.m" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
            </tr>
          </table>
        </td>
        <td>
          III улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=6 && $index<=8">
              <td>{{$index+1}}</td>
              <td ng-if="format=='n'"><input type="number" required ng-model="item.m" placeholder="{{$index+1}}-р сар"/></td>
              <td ng-if="format=='c'"><input type="text" id="field_{{$index}}" required ng-model="item.m" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
            </tr>
          </table>
        </td>
        <td>
          IV улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=9 && $index<=11">
              <td>{{$index+1}}</td>
              <td ng-if="format=='n'"><input type="number" required ng-model="item.m" placeholder="{{$index+1}}-р сар"/></td>
              <td ng-if="format=='c'"><input type="text" id="field_{{$index}}" required ng-model="item.m" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="₮ 1,000,000"/></td>
            </tr>
          </table>
        </td>
      </tr>
    </table>

    <button type="button" class="button red" ng-click="fill()" style="margin-top: 20px; margin-left: 20px;">ИЖИЛ УТГААР</button>
    <button type="button" class="button" ng-click="calc()" style="margin-top: 20px;  margin-left: 20px;">ТООЦООЛОХ</button>
  </div>

  <div id="dialog_sal" title="Цалингийн зардал" class="modal-body">
    <p>Та сонгосон мөрний дэлгэрэнгүй мэдээлэлүүдийг оруулна уу.</p>
    <b>Нийлбэр : {{total | number: 2}}</b>
    <br>
    <table>
      <tr>
        <td>
          I улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=0 && $index<=2">
              <td>{{$index+1}}</td>
              <td>
                <input type="number" required id="field_c_{{$index}}" ng-model="item.c" placeholder="Тоо"/>
                <input type="text" required id="field_a_{{$index}}" ng-model="item.a" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="Цалин"/>
              </td>
            </tr>
          </table>
        </td>
        <td>
          III улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=3 && $index<=5">
              <td>{{$index+1}}</td>
              <td>
                <input type="number" required id="field_c_{{$index}}" ng-model="item.c" placeholder="Тоо"/>
                <input type="text" required id="field_a_{{$index}}" ng-model="item.a" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="Цалин"/>
              </td>
            </tr>
          </table>
        </td>
        <td>
          III улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=6 && $index<=8">
              <td>{{$index+1}}</td>
              <td>
                <input type="number" required id="field_c_{{$index}}" ng-model="item.c" placeholder="Тоо"/>
                <input type="text" required id="field_a_{{$index}}" ng-model="item.a" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="Цалин"/>
              </td>
            </tr>
          </table>
        </td>
        <td>
          IV улирал
          <table>
            <tr ng-repeat="item in selectedArray" ng-if="$index>=9 && $index<=11">
              <td>{{$index+1}}</td>
              <td>
                <input type="number" required id="field_c_{{$index}}" ng-model="item.c" placeholder="Тоо"/>
                <input type="text" required id="field_a_{{$index}}" ng-model="item.a" pattern="^\₮\d{1,3}(,\d{3})*(\.\d+)?$" data-type="currency" placeholder="Цалин"/>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>

    <button type="button" class="button" ng-click="calcSal()" style="margin-top: 20px; margin-left: 20px;">ТООЦООЛОХ</button>
  </div>


  <div id="dialog_items" title="Цалингийн зардал" class="modal-body">
    <p>Та сонгосон мөрний дэлгэрэнгүй мэдээлэлүүдийг оруулна уу.</p>
    <b>Нийлбэр : {{total | number: 2}}</b>
    <br>
    <table>
      <tr ng-repeat="item in selectedArray">
        <td style="width: 40%">
          <input type="text" ng-model="item.item" placeholder="Түүхий эдийн нэр"/>
        </td>
        <td style="width: 15%">
          <input type="number" required id="field_qty_{{$index}}" ng-model="item.qty" ng-change="item.amt=item.qty*item.price" placeholder="Хэмжээ"/>
        </td>
        <td style="width: 20%">
          <input type="number" required id="field_price_{{$index}}" ng-model="item.price" ng-change="item.amt=item.qty*item.price" placeholder="Үнэ"/>
        </td>
        <td style="width: 25%">
          <input type="number" readonly required id="field_amt_{{$index}}" data-type="currency" ng-model="item.amt" placeholder="Нийт зардал"/>
        </td>
      </tr>
    </table>

    <button type="button" class="button" ng-click="calcItems()" style="margin-top: 20px; margin-left: 20px;">ТООЦООЛОХ</button>
  </div>

</body>
<script>
  var user;

  function parseJwt (token) {
      var base64Url = token.split('.')[1];
      var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));

      return JSON.parse(jsonPayload);
  };

  function formatNumber(n) {
    // format number 1000000 to 1,234,567
    return n.replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",")
  }


  function formatCurrency(input, blur) {
    var input_val = input.val();
    if (!input_val || input_val === "") { return; }
    var original_len = input_val.length;
    var caret_pos = input.prop("selectionStart");
    if (input_val.indexOf(".") >= 0) {
      var decimal_pos = input_val.indexOf(".");
      var left_side = input_val.substring(0, decimal_pos);
      var right_side = input_val.substring(decimal_pos);
      left_side = formatNumber(left_side);
      right_side = formatNumber(right_side);
      if (blur === "blur") {
        right_side += "00";
      }

      right_side = right_side.substring(0, 2);
      input_val = "₮" + left_side + "." + right_side;
    } else {
      input_val = formatNumber(input_val);
      input_val = "₮" + input_val;

      if (blur === "blur") {
        input_val += ".00";
      }
    }
    input.val(input_val);

    var updated_len = input_val.length;
    caret_pos = updated_len - original_len + caret_pos;
    input[0].setSelectionRange(caret_pos, caret_pos);
  }

  $("input[data-type='currency']").on({
      keyup: function() {
        formatCurrency($(this));
      },
      blur: function() {
        formatCurrency($(this), "blur");
      },
      focus: function() {
        formatCurrency($(this));
      },
      input: function() {
        formatCurrency($(this));
      }
  });

  function saveFileAs(response) {
     var contentDisposition = response.headers("content-disposition");
     //Retrieve file name from content-disposition
     var fileName = contentDisposition.substr(contentDisposition.indexOf("filename=") + 9);
     fileName = fileName.replace(/\"/g, "");
     var contentType = response.headers("content-type");
     var blob = new Blob([response.data], { type: contentType });
     saveAs(blob, fileName);
 }

  function handleCredentialResponse(response) {
    $.cookie('jwt', response.credential);
    $('#startBtnPlan').show();
  }

  Date.prototype.yyyymmdd = function() {
    var mm = this.getMonth() + 1; // getMonth() is zero-based
    var dd = this.getDate();

    return [this.getFullYear(),
      (mm>9 ? '' : '0') + mm,
      (dd>9 ? '' : '0') + dd
    ].join('-');
  };
</script>

<script src="public/app.js"></script>
</html>
